{% extends "GradeTracker/basepage.html" %}

{% load static %}


{% block content %}
<body>
	
	<h1>Activities</h1>
	<table style="display: inline-block, float:right">
      <tr> 
            <td>Activity</td>
            <td>Activity Weight </td>
      </tr> 
      {% for activity in course.graded_activities_set.all %}
	<tr>
		<td>{{ activity.activity_name }}</td>
		<td>
			<input type="number" name="{{activity.activity_name}}-weight" min="0" max="1"
				value="{{ activity.grade_weight }}" step=".05" readonly/>
		</td>
	</tr>

	{% endfor %}
	</table>

	{% for activity in course.graded_activities_set.all %}
	<table style="display: inline-block">
		<tr>
			<td>{{ activity.activity_name }} SubActivity</td>
			<td>Activity Weight</td>
		</tr>
		{% for subactivity in activity.subgraded_activities_set.all %}
		<tr>
	                <td>{{ subactivity.subactivity_name }}</td>
        	        <td>
                	        <input type="number" name="{{subactivity.subactivity_name}}-weight" min="0" max="1"
                                value="{{ subactivity.subgrade_weight }}" step=".05" readonly/>
	                </td>
		</tr>
		{% empty %}
		<tr>
			<td>None</td>
			<td><input type="text" name="" value="N/A" readonly/></td>
		</tr>
		{% endfor %}
	</table>
	{% endfor %}


  <table>
  {% for activity in course.graded_activities_set.all %}
  <tr>
    <td>
      {{ activity.activity_name }}
    </td>
    <td>
        <input type='checkbox' id='checks{{ forloop.counter }}' />
    </td>
    <td>
	<div id="slider{{ forloop.counter }}" style="width: 20em;"> </div>
    </td>
       </tr>

  {% endfor %}

  <tr>
    <td>
      Total
    </td>
    <td>
        <input type='checkbox' id='check1' />
    </td>
    <td>
      <div id="slidertotal" > </div>
    </td>
      </tr>
    
  </table>


</body>


{% endblock %}

{% block script %}

  function getTotal(){
	var total = 0;
	{% for activity in course.graded_activities_set.all %}
		total += $('#slider{{forloop.counter}}').slider("option", "value") * {{activity.grade_weight}};
        {% endfor %}
	return total;
  }

  
$(function() {
    {% for activity in course.graded_activities_set.all %}
      $( '#slider{{ forloop.counter }}' ).slider({ min:0.0, max:1.0, step:.01, value : {{activity.grade_earned}}});
    {% endfor %}
    $( "#slidertotal" ).slider({ min:0.0, max:1.0, step:.01, value:getTotal()});
  });

$('document').ready(function(){
{% for activity in course.graded_activities_set.all %}
  $( "#slider{{ forloop.counter }}" ).slider( {change: function(){
	$('#slidertotal').slider("value", getTotal());
  }});
{% endfor %}



  $('#slidertotal').slider({stop:function(event, ui){
	var total = getTotal();
	var diff = ui.value-total;
	{% for activity in course.graded_activities_set.all %}
		var temp = $('#slider{{forloop.counter}}').slider("option", "value");
		$('#slider{{forloop.counter}}').slider("value", temp+diff); 
	{% endfor %}
  }});

});



/*
  var temptotal = 0;
  var tempsinlge = 0;
  var remainder = 0;
  var total = document.getElementById('slidertotal').value;
<<<<<<< HEAD
  var total = parseFloat(total);
=======
  total = parseFloat(total);

  $('#slidertotal').mousedown(function(){
  
  });
>>>>>>> 123164f514b8623be509227a42c7e2a414a6688b

  function getTotal(){
  temptotal = 0;
        {% for activity in course.graded_activities_set.all %}
    tempsingle = document.getElementById('slider{{ forloop.counter }}').value * {{ activity.grade_weight }};
                temptotal += tempsingle;
        {% endfor %}
  total = temptotal;
  }


$( "#slidertotal" ).bind( "slider:changed", function( event, data ) {
  getTotal();
  $("#slidertotal").simpleSlider("setValue", 
    total );   
  });

{% for activity in course.graded_activities_set.all %}
  $( "#slider{{ forloop.counter }}" ).bind( "slider:changed", function( event, data ) {
  event.stopImmediatePropogation();
  getTotal();
  $("#slidertotal").simpleSlider("setValue", 
    total );   
  });

{% endfor %}
*/
{% endblock %}
